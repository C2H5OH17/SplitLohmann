---
date: 2025-06-16
aliases:
  - Split-Lohmann Multifocal Displays
tags:
  - 文献阅读笔记
  - 中文翻译
  - 注释
  - 分体罗曼
---
原文网址：[Split-Lohmann Multifocal Displays](https://imaging.cs.cmu.edu/split_lohmann/)
![[1.png]]
**图1. 分体式罗曼多焦点显示器** 本文设计了一种近眼 3D 显示器，能够使用单次曝光同时生成一组密集的焦平面。我们的关键创新是一种光学装置（我们称之为分体式罗曼装置），它在利用传统显示器投影高程度局部控制方面实现了重大突破。给定 RGB 图像形式的场景，我们使用单个 RGB 显示器，同时以（调制）焦点堆栈图像的简单解析函数形式呈现颜色信息和局部空间光。这些焦点堆栈图像是从实验室原型的深度图中获取的。这无需进行时间复用$^{[1]}$就能在 3D 多焦点观察器中生成视图，且该视图不会因显示器而产生扭曲。分体式罗曼显示器具备诸多理想特性，包括能够处理工作范围大、深度图复杂的场景，具备高空间和深度分辨率以及大 [[étendue]]（光学扩展量 ）。我们计算流程的极致简洁性，也使得交互性 3D 内容（如 3D 场景）能够实现实时操作。致谢：3D 场景由 Blender 市场的 “Entity Designer” 提供 。
> [!注释 1 ：]
>**时间复用技术**：时间复用技术通过快速切换显示内容（如不同焦平面的图像或散斑图案），利用人眼的**视觉暂留效应**（Persistence of Vision）将离散的时序图像融合为连续的感知画面，从而实现高质量的全息显示效果。主要缺陷是计算负担大。

本研究呈现了一种多焦点显示器的设计，该显示器能够在单次曝光中生成一组密集的焦平面。我们通过使用一种创新的计算透镜来实现这一点，该透镜在焦距方面具备空间选择性，即透镜后方看似存在一个多焦点透镜，其通过对显示器上一组适当选定的空间变化焦距进行合理聚焦，实现了多焦点显示效果，从而无需借助传统的耗时复用技术。这一设计的核心是对洛曼透镜（Lohmann lens ）进行改进，用两个相位板来传递相对位移。利用光学中继和立方空间光调制器，我们用光学元件取代了物理透镜，使不同的焦平面能够以不同的放大倍率进行成像，同时让不同的像素组经历不同程度的变换，进而实现不同的聚焦效果。我们将这种设计称为分体 - 罗曼（Split - Lohmann ）多焦点显示器。分体 - 罗曼显示器具备大光学扩展量（étendue ）以及高空间和深度分辨率；无需进行时间复用，且计算流程极为简洁，这使其适用于视频和交互式内容处理，能带来舒适的观看体验。通过一台实验室原型设备，我们展示了其在静态、动态和交互式 3D 场景中，在大工作范围内呈现出高视觉质量的效果。

**CCS 概念**：硬件 → 显示器和成像器；计算方法 → 虚拟现实。

补充关键词和短语：
多焦点显示器、计算全息、调节 - 辐辏冲突、洛曼透镜。

ACM 引用格式
Yingsi Qin, Wei-Yu Chen, Matthew O'Toole, and Aswin C. Sankaramarayamam 2023. Split-Lohmann Multifocal Displays. ACM Trans. Graph.42,4, Article 57 (August 2023),18 pages. https://doi.org/10.1145/3592110

（注）Authors' addresses: Yingsiq Yin, yingsiqyin@andrew.cmu.edu; Wei-Yu Chen, weiyuchen@andrew.cmu.edu; Matthew O'Toole, mptotole@andrew.cmu.edu; Aswin C. Sankaranarayanan, aswinaswin@andrew.cmu.edu, Carnegie Mellon University, 5000 Forbes Ave., Pittsburgh, PA, 15213, USA.
Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for components of this work owned by others than the author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Contact permissions@acm.org.
© 2023 Copyright held by the author(s)/author(s). Publication rights licensed to ACM.
0730-0342/23/8/ART57 $15.00
https://doi.org/10.1145/592110
# 1 引言
当我们凝视周围的世界时，部分场景会清晰聚焦，其余则处于离焦状态。眼睛如同一个透镜，通过改变焦距，能够聚焦于特定深度的物体，清晰分辨其细节，而其他深度的物体则会失焦。眼睛的这一特性 —— 被称为调节 —— 是 3D 显示器需要满足的一项重要视觉线索。
要满足调节线索的要求，显示器需要以光学方式将内容呈现在所需深度处。从基础波动光学的角度来看，我们可以推断，放置在不同深度的点光源之间的差异，正是波前像差的体现。具体而言，点光源会发出球面波前，这种波前在传播过程中会逐渐变平。因此，为了适配眼睛的调节功能，3D 显示器需要为虚拟场景中的每个点引入具有深度相关曲率的球面波前 。
在显示器中实现调节功能的方法有很多。最简单的方法或许是使用调焦透镜，这种透镜在多焦点显示器中较为常见 [Akeley 2004; Liu et al. 2008; Love et al. 2009; Rolland et al. 2000] ，在变焦显示器中也有应用 [Aksit et al. 2017; Jonsson et al. 2016; Padmanaban et al. 2017] 。在这类显示器中，调焦透镜可对出射波前的曲率进行控制。将显示器置于调焦透镜后方，通过选择调焦透镜的焦距，能够使显示器呈现出不同的深度效果。然而，调焦透镜不具备空间选择性，也就是说，显示器的所有像素都会映射到同一个焦平面，即无法针对显示内容的不同深度进行相应调整。3D 场景是通过快速改变调焦透镜的焦距，依次切换多个焦平面来生成的。由于人眼的视觉暂留特性，时间复用的焦平面会被感知为一个 3D 场景。但时间复用存在其自身的一系列挑战，这是因为需要提高显示器的带宽电子设备性能。例如，显示器的帧速率会随着我们想要显示的焦平面数量线性增加。这就引出了一个问题：是否有可能制造出一种 “透镜”，能够同时将显示器的不同像素投射到不同的深度呢？
本文提出一种独特的系统，能够实现带空间选择性的调焦功能，即让显示器不同区域呈现出不同的焦距。我们通过改进版的洛曼透镜（Lohmann lens ）实现这一点 —— 洛曼透镜是一种经典的调焦透镜，由两块共定位的立方相位板构成 。当两块立方相位板相对平移时，会产生二次相位差，进而形成焦距随板间平移量变化的透镜。传统洛曼透镜不具备空间选择性；此外，它依赖机械运动来调节焦距，这在由电子控制的 reliance lenses（可能是 “光焦度可变透镜” 等，结合语境推测，原文若为 “liquid lenses” 更合理，暂按原文译 ）中是较差的选择，因为电子控制难以精准配合机械运动。我们的创新点在于对洛曼透镜进行改进，使其具备空间选择性，同时用光学平移取代机械运动。我们将改进后的系统命名为 “分体 - 罗曼（Split - Lohmann ）” 多焦点显示器 。
分体 - 罗曼显示器基于以下几方面改进实现：首先，我们通过 4f 中继系统，在物理上分离两块立方相位板，同时实现它们的光学共定位。其次，我们在 4f 系统的傅里叶 / 光瞳平面中引入一个相位型空间光调制器（SLM） 。SLM 上的相位斜坡（其作用类似于棱镜或衍射光栅 ），能产生与机械运动等效的效果，因为它处于立方相位板的傅里叶平面，使我们可通过电子方式控制立方相位板之间的平移量，进而控制所得透镜的焦距。第三，为实现焦距的空间选择性变化，我们在空间光调制器上对显示器进行光学共定位，并局部改变 SLM 上相位斜坡的斜率。通过在显示器的不同区域呈现局部相位斜坡斜率，可对应立方相位板之间不同的平移量；相应地，每个区域会呈现出焦距不同的透镜（并处于不同深度 ），从而实现所需的（具备空间选择性的焦距 ）能力 。
图 1 展示了我们实验室原型的测试结果。该原型能够生成多焦点场景，具有以下特点：在空间分辨率方面，其多焦点场景可基本保持显示屏的原生分辨率；在深度分辨率方面，在 4 个[[屈光度]]的工作范围内，深度分辨率超过 1/8 屈光度；在时间分辨率方面，其时间分辨率等同于显示屏和空间光调制器（SLM）的原生帧率。此外，该原型的光学扩展量很大，其大小仅受所选用光学透镜的限制。
## 1.1 贡献
本文提出了分体 - 罗曼多焦点显示器，这是一种单次曝光 3D 显示器，能够在深度选择性方面实现极高的空间分辨率。
- **可编程分体 - 罗曼透镜**：我们研究贡献的核心是一种新型洛曼风格的调焦透镜，可提供空间变化的焦距。我们利用该系统实现了一种大工作范围、焦平面采样密集的单次曝光多焦点显示器。
- **设计与空间分析**：我们对焦平面展开深入分析，包括对各种特性（光学扩展量、深度范围、分辨率）以及可能出现的像差进行表征。
- **实时内容生成**：所提显示器具备近实时内容生成能力。输入的 RGBD（红、绿、蓝、深度）内容与显示器显示图案及空间光调制器（SLM）相位之间的解析映射，加之极低的计算开销，使我们能够实时处理交互式场景（如 3D 游戏），且对硬件要求不高。
- **实验室原型**：我们设计并搭建了一台实验室原型设备，展示其在虚拟及交互式 3D 场景中的性能表现 。
这一显示设计方面的进展，使我们无需时间复用就能改进多焦点显示器的现有技术水平，助力其实现众多理想功能。我们已在项目网站上发布了相关代码 [https://github.com/Image-Science-Lab-cmu/SplitLohmann] ，以方便重复验证，并开展后续研究 。
## 1.2 局限性
所提系统存在接近深度不连续的像差问题，这是由显示器映射到空间光调制器（SLM）的 4f 系统方式导致的。具体而言，我们的系统要求其中一块立方相位板出现在 4f 系统的光瞳 / 傅里叶平面，这会在典型设计空间中引入空间范围达数十微米的大幅模糊。我们详细描述了这些像差的影响和表现；不过，在通过模拟以及在实验室原型上获得的结果中，这些像差并非特别令人分心（影响观看体验）。我们提出的系统还完全依赖 4f 中继的特性，这使得系统不够紧凑。实现紧凑化或许是推动实际应用的关键步骤。此外，本文呈现的成果仅针对单目聚焦情况；要充分发挥分体 - 罗曼显示器的优势，即其解决[[辐辏 - 调节冲突]]的能力 [Hoffman et al. 2008] ，我们需要开展用户研究，评估深度感知和沉浸式体验。最后，我们的显示器是多焦点显示器，会继承这类显示器常见的一些局限性，例如，由于离焦模糊在不同焦平面的泄漏，会导致遮挡线索和对比度减弱 。

# 2 已有研究

我们简要讨论 3D 显示器领域的先前研究工作，聚焦于与我们的研究有相似之处的技术。鉴于洛曼透镜（Lohmann lenses）在本研究中的核心作用，我们也会详细论述这类透镜 。
## 2.1 多焦点显示器

多焦点显示器可在多个虚拟焦平面上呈现 3D 内容。目前已有众多多焦点显示器的实现方案，以下介绍与我们研究最相关的几种，更全面的综述可参考其他文献（Koulieris et al. 2019; Zhan et al. 2020 ），本文暂不对该主题做详尽梳理。
从本质上讲，本文所开发的技术通过避免时间复用，以一种受限的方式实现了多焦平面显示。具体而言，偏振敏感透镜可借助聚焦不同偏振态，同时提供两种焦距。通过控制显示像素的偏振态，我们能够将内容呈现在两个焦平面之一（Tan et al. 2018 ） 。然而，偏振方法受限于两个独立模式，这就将显示器限制为双焦平面显示 。
另一种避免时间复用的方法是牺牲显示器的空间分辨率。早期的工作，如 Akeley 等人（2004 年）的研究，使用分束器装置将显示器的不同部分放置在距目镜不同的距离处。Cui 和 Gao（2017 年）在显示器和目镜之间采用了 4f 系统，傅里叶平面中的衍射光学元件经过设计，可在显示器的预定区域引入空间轴向位移，同时将这些区域横向移至光学轴中心。所有这些设计都存在相同的空间分辨率限制，具体而言，分配给每个焦平面的像素数量受到焦平面数量的限制，焦平面数量越多，每个焦平面的像素数就越少（呈反比关系）。
“调节不变性”（Konrad 等人，2017 年）为解决眼部聚焦问题提供了另一种方法：通过在视觉暂留范围内扫描显示器，产生焦深范围内的模糊效果。然而，这不可避免地会导致显示器所呈现内容在空间分辨率上的损失，而人眼正是以该分辨率感知显示内容的 。
焦面显示器（Matsuda et al. 2017）采用相位型空间光调制器（SLM），在显示器和目镜之间放置曲面，以实现空间变化的焦距。从概念上讲，这与我们要解决的问题相同，即实现空间变化的透镜效果。然而，直接将 SLM 用作空间变化的透镜存在一定局限性。具体而言，某些限制会导致生成的焦面不够平滑。部分原因在于 SLM 本身的局限性，此外，显示器上高度重叠的 SLM 像素集也会造成这种情况。包含深度不连续的大场景会被分割为多个平滑的焦面进行显示，这与我们的方法形成对比，分体 - 罗曼显示器无需时间复用，并且通过将场景按深度（以屈光度衡量）量化，能够以高分辨率处理大场景。与焦面显示器（如实现的自适应多焦显示器）相比，分体 - 罗曼显示器通过减少时间复用帧数，显著降低了深度误差。分体 - 罗曼显示器推动这一趋势进一步发展，可实现更小的深度误差；例如，我们的实验室原型显示器在超过 0.4 屈光度的工作范围内，理论上可支持 50 个焦平面，深度误差为 0.004 屈光度。最后，确定实现单焦面或多焦面的 SLM 相位图案需要解决一个优化问题，而我们的设计避免了大量的计算开销。因此，我们可以轻松地将视频甚至交互式内容适配到我们的原型设备上，正如我们在第 5 节中所展示的。另一方面，焦面显示器已以紧凑的外形实现，而我们的实验室原型属于扩展型设计 —— 若要将其转化为可头戴的紧凑型设备，可能需要相当复杂的光学工程技术。综合来看，焦面显示器为我们的设计提供了一个有趣的替代方案，我们通过模拟和实际测试结果对两者进行了对比分析。
## 2.2 洛曼透镜和阿尔瓦雷斯透镜

洛曼 [Lohmann 1970] 和阿尔瓦雷斯 [Alvarez and Humphrey 1978; Alvarez 1978] 透镜为实现焦距可调透镜提供了一种方案，该方案利用两个平移的立方相位板。这两种透镜背后的基本原理均为两个平移立方相位板的相互作用。假设我们有两个堆叠在一起的立方相位板，其高度图分别为 $h_1(x) = \frac{x^3}{c_0}$ 和 $h_2(x) = -\frac{x^3}{c_0}$ ，其中  $c_0$ 决定立方相位板的曲率， $c_0$ 越小，曲率越大。由于这两个相位板堆叠在一起，它们产生的相位调制为：
$$\exp\left[-j\frac{2\pi}{\lambda}\left(h_1(x)+h_2(x)\right)(\eta-\eta_{air})\right] \tag{1}$$
其中，$\lambda$ 为工作波长；$\eta$ 和 $\eta_{\text{air}}$ 分别为相位板材料和空气的折射率。乍一看，这种高度图的选择似乎有违直觉，因为 $h_1(x) + h_2(x)$ 是均匀为零的；也就是说，堆叠后的相位板不会调制入射波前。然而，如果将这两块相位板沿相反方向平移，比如平移 $\pm\Delta$ ，那么产生的相位调制可表示为：
$$h_1(x+\Delta)+h_2(x - \Delta)=\frac{(x+\Delta)^3-(x - \Delta)^3}{c_0}=\frac{6\Delta x^2 + 2\Delta^3}{c_0}\tag{2}$$
忽略与 x 无关的常数项，将公式 (2) 代入公式 (1)，我们得到相位调制：
$$\exp\left[-j\frac{2\pi}{\lambda}\frac{12\Delta(\eta - \eta_{\text{air}})}{c_0}\frac{x^2}{2}\right] \tag{3}$$
平移后的相位板会在入射波前上叠加一个二次相位，其效果等同于一个焦距为以下值的透镜：
$$\frac{c_0}{12\Delta(\eta - \eta_{\text{air}})} \tag{4}$$
不同焦距的透镜可通过简单改变相位板之间的平移量来获得。
洛曼透镜和阿尔瓦雷斯透镜均利用平移立方相位板的原理来制造焦距可调透镜，且都已被用于构建多焦点显示器 [Wilson and Hua 2019]；二者的关键差异源于它们向二维相位板拓展的方式。洛曼透镜通过采用高度分布：
$$h(x,y) = \frac{x^3 + y^3}{c_0} \tag{5}$$
产生可分离的相位函数，这要求相位掩模（masks：指立方相位板）的平移沿 $x = y$ 轴进行，或者沿两个轴进行等量平移。阿尔瓦雷斯采用了一种略有不同的排列方式，要求沿 $x$ 轴平移（而非沿 $y$ 轴 ）。这些透镜之间的差异在先前的研究中已得到广泛探讨 [Barbero 2009]。在我们的实现中，我们使用洛曼透镜；不过，在我们的理解中，我们的理念也可通过阿尔瓦雷斯透镜实现，且几乎不会有差异。
## 2.3 全息显示器
全息显示器 [Maimone et al. 2017] 的目标是利用相位空间光调制器（SLM）生成与场景关联的波前。虽然我们提出的工作也使用相位 SLM 来塑形波前，但存在一些值得阐述的差异。
在全息显示器中，入射光通常（但并非总是）是空间相干的，呈准直光束形式，因其光源的立体角为零（点光源），所以扩展程度为零。SLM 会将这种立体角扩大一小部分（由 SLM 决定 ）。这就导致了经典限制：出射立体角受限于 SLM 的像素数。相比之下，Split-Lohmann 系统中入射到 SLM 的光为空间非相干光 —— 在空间和角度上均是密集分布的，立体角由显示器决定。实际上，最先进的全息显示器需要仔细建模显示器硬件中的像差 [Shih et al. 2022]，并使用相机进行无透镜优化 [Chakravarthi et al. 2020；Peng et al. 2020] 以及借助深度神经网络。相反，Split-Lohmann 系统在计算上轻量化，支持 3D 显示的交互应用。
在这两种显示器中，两种方法均旨在生成与场景关联的波前。全息显示器将波前生成的全部任务交由 SLM 承担，受益于由此带来的紧凑性。而 Split-Lohmann 系统利用光学元件（立方相位板）生成所需的二次波前，这些相位板起到选择算子的作用。这避免了受限于有限的扩展程度，但代价是需要庞大的光学元件。

# 3 Split-Lohmann 显示器

本节介绍支撑本研究的主要思路。我们从使用焦距可调透镜的传统多焦点显示器入手，逐步推导至所提出的 Split-Lohmann 显示器。
## 3.1 传统多焦点显示器
图 2 (a) 展示了多焦点显示器的示意图，该显示器由平移显示器和目镜组成。假设目镜的焦距为 $f_e$ ，将显示器放置在距离目镜 $f_e$ 处，会使显示器像素发出的光经准直后平行出射；最终结果是显示器在光学上位于无穷远处。将显示器移近目镜，会使显示器在光学上位于距离目镜小于无穷远的位置。人眼放置在目镜的焦点处，即距离透镜 $f_e$ 处。与将眼睛直接贴在目镜上的做法相比，这种设置有一定优势，相关细节将在 4.2 节详细阐述。
图 2 (b) 展示了一种使用焦距可调透镜（基于洛曼透镜实现）的多焦点显示器实现方案。在此方案中，我们无需物理平移显示器，而是借助焦距可调透镜，在光瞳 / 傅里叶平面完成光学平移。当焦距可调透镜的光焦度为零（或处于某一标称的 “无穷远焦距” 状态 ）时，4f 透镜系统会在焦平面上生成显示器的像。改变焦距可调透镜的光焦度，会使焦平面沿光轴方向平移；需注意的是，这一过程会让整个波前沿光轴发生平移 —— 原本承载波前的平面，此时会出现在新的位置。当可调透镜的光焦度偏移时（相应地，若为凸透镜，会使显示器偏离目镜 ）；而对于负光焦度（即发散透镜效果，对应负焦距 ），则呈现相反情况。最终，通过将目镜与 4f 中继系统生成的虚拟显示器范围进行适配性放置，就能实现图 2 (a) 所示的系统设置。
![[2.png]]
**图 2. Split - Lohmann 多焦点显示器的推导过程** 我们从传统的多焦点显示器模型入手，显示器置于目镜之后，如图 (a) 所示。借助 4f 中继系统和焦距可调透镜（如图 (b) 所示 ），可避免显示器的物理移动。在此方案中，通过改变洛曼透镜的焦距，可获得与显示器物理平移等效的效果。洛曼透镜的平移会使显示器的立方相位板产生光轴方向的平移。为避免移动显示器的立方相位板，可使用 4f 中继系统，并改用线性相位斜坡来实现等效平移（如图 (c) 所示 ）；此时，需在立方相位板的傅里叶平面引入相位斜坡。综合上述步骤，在图 (d) 中，我们让显示器与相位斜坡的 4f 系统分离，使用相位空间光调制器（SLM ）。该方法可确保显示器像素现在能在 SLM 上以局部方式解析，立方相位板的影响被调制到显示器像素上产生的效果。通过实现具有逐点恒定斜率的相位图案，我们使显示器上的轴向平移呈空间变化；我们将此系统称为 Split - Lohmann 多焦点显示器。
## 3.2 Split-Lohmann 显示器

我们现将介绍一种设计，它既避免了洛曼透镜中的物理移动，又摒弃了依赖时间复用生成多焦点内容的方式 。
### 3.2.1 避免物理移动
我们借助图 2 (c) 所示的设置来避免物理移动。我们拆分构成洛曼透镜的两块立方相位板，同时通过将它们放置在一个 4f 中继系统的两端，来维持二者的共位关系。因为 4f 中继系统会沿光轴翻转平面，所以在其中继系统的标称状态下，这两块立方相位板会相互抵消作用 。
为在无需机械运动的情况下实现傅里叶光学平移，我们依靠傅里叶光学。基础傅里叶分析表明，信号的平移可通过对其频率域对应项施加线性相移来实现。线性相移的斜率控制着平移量。在我们的设置中，这意味着在立方相位板的傅里叶平面引入相位斜坡。这样的相位斜坡可通过相位空间光调制器（SLM）实现。利用这一点，我们让第一块立方相位板相对于第二块产生相移；结合 2.2 节引入的符号，有效相位调制与下式成比例：
$$(x+\Delta)^3 - x^3 = 3\Delta x^2 + 3\Delta^2 x + \Delta^3 \tag{6}$$
与公式 (2) 对比，忽略常数项，我们可观察到二次相位项 $3\Delta x^2$ ，这使得焦距可调透镜的焦距由相位斜坡在空间光调制器（SLM）上的斜率控制。我们还观察到一项与 $x$ 呈线性关系的额外项；这是仅平移其中一块立方相位板的结果。这种线性相位项的影响将在 4 节中更详细地探讨。
### 3.2.2 避免时间复用
我们首先观察到，显示器与空间光调制器（SLM）在光学上是对准的，正如图 2 (d) 中所示。如果中间没有立方相位板，使用 4f 中继系统可确保显示器像素被解析到空间光调制器（SLM）上。我们可以用在空间光调制器（SLM）上呈局部斜坡状的相位来替代全局相位位移；这意味着，根据施加在空间光调制器（SLM）上的相位斜坡的斜率，我们能够引入不同选择的焦距。实质上，我们在焦距可调透镜的光焦度选择中实现了空间选择性，这使我们能够避免对所有焦距进行时间复用。
Split-Lohmann 显示器具备诸多理想特性。例如，在多焦点显示器领域，近期的一些成果大幅增加了所显示焦平面的数量 [Chang et al. 2018; Jo et al. 2019; Ramezani et al. 2018]，但这是以高能耗、高帧率显示器以及高带宽电子设备为代价的。相比之下，我们的单镜头系统能提供数量相当的焦平面，且采用标准显示器即可实现。如 4 节所述，我们的系统具有较大的光学扩展量；在很大程度上，我们受限于所用光学元件的数值孔径。我们显示器的内容生成在计算上是轻量级的，因为从输入的 RGBD 内容到相位空间光调制器（SLM）图案的映射近乎解析；相应地，这使我们能够轻松展示实时交互的 3D 游戏等内容。
该设计的一个局限在于，我们并未在显示器和空间光调制器（SLM）之间建立点对点映射，因为二者间的 4f 中继系统在其傅里叶平面中存在一块立方相位板。因此，显示器上的一个像素发出的光会在 SLM 上扩散到多个像素上，形成由立方相位板、中继透镜焦距等参数决定的点扩散函数（PSF）。一般而言，在我们的模拟和实验室原型中，该点扩散函数的尺寸可达 50 至 100 个 SLM 像素，甚至更多。这也限制了我们设计所提供的深度空间选择性。我们接下来会详细讨论这些内容。
# 4 Split-Lohmann 显示器的设计
本节将提供基于波动光学的 Split-Lohmann 多焦点显示器的形成模型，后续用于系统的设计和分析。
## 4.1 Split-Lohmann 显示器中的图像形成
我们将阐述光线在该系统中传播的图像形成模型。这一推导在很大程度上依赖于透镜的傅里叶变换特性以及 4f 系统的空间滤波。我们在此涵盖最重要的细节，完整论述请查阅补充 PDF 文档。
### 4.1.0 预备知识
4f 系统由两个透镜组成，我们假设它们具有相同的焦距 $f_0$，并分别放置在距输入平面（记为 $P_1$ ）$f_0$ 和 $3f_0$ 的位置。距 $P_1$ 为 $2f_0$ 的平面（即两个透镜之间的中点平面 ）是傅里叶平面（或瞳平面 ），记为 $P_2$ ；距 $P_1$ 为 $4f_0$ 的平面是输出平面，记为 $P_3$ 。我们假设这些透镜是理想透镜。
本文中的分析需要用到四个基本特性。
- **透镜的傅里叶变换特性：** 当 $u_1(x_1, y_1$) 是入射到 $P_1$ 处的波时，传播到 $P_2$ 后的波可表示为：
	$$u_2(x_2, y_2) = \frac{1}{\lambda f_0} U_1\!\left(\frac{x_2}{\lambda f_0}, \frac{y_2}{\lambda f_0}\right)$$
	其中 $U_1$ 是 $u_1$ 的傅里叶变换。

- **场中继：** 若 $P_2$ 处无光学元件，那么 $P_3$ 处的相量场（记为 $u_3(x_3, y_3)$ ）可表示为：
	$$u_3(x_3, y_3) = u_1(-x_3, -y_3) \tag{7}$$
	这使得 4f 系统成为理想的场中继系统。
-  **$P_2$ 处的线性相位斜坡：** 当 $P_2$ 处存在棱镜或形如以下形式的线性相位斜坡时：
	$$\exp\left[-j \frac{2\pi}{\lambda} (x_2 u_0 + y_2 v_0)\right]$$
	那么 $P_3$ 处的场是 $u_1$ 经移位（且翻转 ）后的副本：
	$$u_3(x_3, y_3) = u_1\!\left(-x_3 + u_0 f_0, -y_3 + v_0 f_0\right) \tag{8}$$
	 为便于分析，在此处及后续分析中，我们忽略任何限制光阑的影响。
- **$P_2$ 处的透镜：** 在 $P_2$ 处放置一个焦距为 f 的透镜，会导致 $P_3$ 处的场发生轴向平移。具体而言，原本出现在 $P_3$（或距 $P_1$ 为 $4f_0$ 距离处 ）的波 $u_1(-x_3, -y_3)$ ，会轴向平移至：
	$$4f_0 + \delta_z = 4f_0 - \frac{f_0^2}{f}. \tag{9}$$
我们现在详细剖析 Split-Lohmann 显示器中的波前传播和成像过程。该分析还会涉及设计中不同像差源，并给出一种评估其影响的机制。具体而言，我们推导在系统中不同位置（专门标记为平面 $P_1, \dots, P_5$ ）形成的波前，光线从显示器传播到眼睛时，每个平面与前一个平面相距 $2f_0$ 。图 3 给出了该分析的直观概览。
![[3.png]]
**图 3. Split-Lohmann 多焦点显示器的分析** 该图展示了来自三个不同点的波的传播情况，通过颜色编码便于可视化。所有点在显示器上起始时，均为 $P_1$ 处的理想点光源，彼此不相干。 $P_2$ 处的相位板会向这些点引入立方相位。在置于 $P_3$ 处的空间光调制器（SLM）上，每个点观测到的相位梯度不同，即公式 (13) 中 $v_0$ 的取值不同：黄色点取零，红色点取小的正值，绿色点取绝对值更大的负值。这会导致在 $P_4$ 处，相互干涉的立方波前之间产生不同程度的偏移；经过第二块立方相位板后，产生的波对于黄、红、绿点而言，分别为平面波、会聚二次波和发散二次波。因此，每个点在 $P_5$ 处会发生不同程度的轴向偏移，而 $P_5$ 处正是平移后的虚拟显示器形成的位置。
- $P_1$：显示器 
	我们假设显示器具有空间非相干像素，发出窄带照明，中心波长约为 $\lambda$ 。空间非相干性使我们能够单独分析像素，因为它们的波前不会相互干涉。在实现方面， OLED 显示器以及大面阵的液晶显示器（Liquid Crystal Display ），作为类似点光源的背光，为我们提供了良好的近似，其光源在显示器上的位置为 $(x_0, y_0)$ 。我们现在将追踪该点光源的波前在系统中的传播。为便于直观呈现，图 3 中突出显示了几个这样的点。
- $P_2$：第一块立方相位板
	第一个透镜将来自 $P_1$ 处点的光准直后射向 $P_2$ ；$P_2$ 处，立方相位板前的波前可表示为：
	
$$u_{2-}(x_2, y_2) = \frac{1}{\lambda f_0} \exp\left[-j \frac{2\pi}{\lambda} \frac{x_2 x_0 + y_2 y_0}{f_0}\right] \tag{10}$$
	立方相位板会将该波前改变为：
	$$u_{2,+}(x_2, y_2) = u_{2,-}(x_2, y_2) \exp\left[-j \frac{2\pi}{\lambda} \frac{x_2^3 + y_2^3}{c_0}\right] \tag{11}$$
	其中，$c_0$ 决定相位板的曲率。
- $P_3$：相位空间光调制器（SLM）
	波前到达 $P_3$ 处，$P_3$ 距离 $P_1$ 为 $4f_0$ ，其瞳平面 / 傅里叶平面处有一块立方相位板。若我们将 $h(\cdot,\cdot)$ 记为立方相位板的傅里叶变换，那么放置在 $P_3$ 处的空间光调制器（SLM）前的波前可表示为：
	$$u_{3,-}(x_3, y_3) = h(x_3 + x_0, y_3 + y_0). \tag{12}$$
	![[插图1.png]]
	也就是说，我们观测到的波前 $h(x, y)$ 会因位置 $(-x_0, -y_0)$ 发生移位。此波前会被空间光调制器（SLM）进行相位调制。上述 $h$（即立方相位板的点扩散函数 ）的模平方，在上方插图中展示，该插图呈现了我们原型设备的参数。
	如 3 节所述，Split - Lohmann 显示器在 $P_3$ 处的空间光调制器（SLM）上采用分段线性的相位函数。不过，为便于分析，我们先从 $P_3$ 处单个相位斜坡的情况入手。对于完全处于线性相位斜坡内的点，该假设是准确的，关于分段线性相位函数的更深入分析将留到 4.5 节进行。据此，经过 SLM 后的波可表示为：
	$$u_{3,+}(x_{3},y_{3})=u_{3,-}(x_{3},y_{3})\exp\left[-j\frac{2\pi}{\lambda}(x_{3}+y_{3})v_{0}\right]$$
	在此，$v_0$ 是斜率参数，用于控制我们在 $P_4$ 处波前上引入的偏移量。如 2.2 节所述，洛曼透镜需要沿两个轴方向有相同的偏移量，因此，对于 x 轴和 y 轴，我们使用相同的斜率参数 $v_0$ 。$v_0$ 的具体取值由我们想要呈现的深度图决定；我们之后会更详细地讨论这一点。
- $P_4$：第二块立方相位板
	基于 $P_3$ 处波前集中在空间光调制器（SLM）单个线性区域的假设，从 $u_{2,+}$ 到 $u_{4,-}$ 的光路属于傅里叶平面带有线性相位斜坡的 4f 系统；因此，第二块立方相位板前的波前，是 $P_2$ 处波前经平移后的副本。令 $\Delta = v_0 f_0$ ，根据公式 (8)，可将其表示为：
	$$u_{4,-}(x_4, y_4) = u_{2,-}(-x_4 + \Delta, -y_4 + \Delta) \exp\left[-j \frac{2\pi}{\lambda} \frac{(-x_4 + \Delta)^3 + (-y_4 + \Delta)^3}{c_0}\right] \tag{14}$$
	经过一些简化并忽略常数项后，第二块立方相位板后的波前 $u_{4,+}(x_4, y_4)$ 可写成：
	$$
	\underbrace{u_{2,-}(-x_4 + \Delta, -y_4 + \Delta)}_{\text{(plane wave from display)}} \underbrace{\exp\left[-j \frac{2\pi}{\lambda} \frac{3\Delta (x_4^2 + y_4^2)}{c_0}\right]}_{\text{(quadratic phase term)}} 
	\underbrace{\exp\left[j \frac{2\pi}{\lambda} \frac{3\Delta^2 (x_4 + y_4)}{c_0}\right]}_{\text{(linear phase term)}} 
	\tag{15}$$
	由于 $u_{2,-}$ 对应平面波前，其平移仅会使其产生一个常数（标量）的变化。
	换言之，第二块立方相位板后的波前，与第一块立方相位板前的波前相同，但乘以了两个相位项：一个二次项，对应焦距为 $f = c_0/(6\Delta) = c_0/ (6v_0 f_0)$ 的透镜；还有一个线性项。如我们所见，**二次项会使该点产生所需的轴向偏移，而线性项会导致不必要的横向偏移**。
- $P_5$：虚拟显示平面
	若忽略公式 (15) 中的二次相位项和线性相位项，那么 $P_5$ 处的波前与 $P_1$ 处的波前相同，是一个以 $(x_0, y_0)$ 为中心的冲激函数（$\delta$ 函数 ）。根据公式 (9)，二次相位项会引发轴向偏移 $\delta_z = -\frac{f_0^2}{f_t}$ ，因此，这个冲激函数会出现在以下位置：
	$$\delta_z = -\frac{6v_0 f_0^3}{c_0} \tag{16}$$
	相对于 $P_5$ 平面，正数值表示朝着视场方向的位移。由于我们控制着空间光调制器（SLM）上的相位项 $v_0$，我们能够将显示像素放置在距视场特定的轴向距离处，进而使眼睛感知到它来自期望的深度。
	线性相位项也会产生横向偏移，使得冲激函数出现在：
	$$\left(x_0 - \frac{3v_0^2 f_0^3}{c_0}, y_0 - \frac{3c v_0^2 f_0^3}{c_0}\right) \tag{17}$$
	这种横向偏移是不期望出现的，但由于其与 $v_0^2$ 相关，通常非常小；我们将在本节后续内容中更详细地讨论它。
## 4.2 确定系统参数
前文所描述的 Split - Lohmann 多焦点显示器如图 2 所示，并且有多个自由参数，包括：$f_e$（视场透镜的焦距 ）、$f_0$（中继透镜的焦距 ）以及 $c_0$（决定立方相位板曲率的参数 ）。每个参数都控制着显示器的显著属性，比如视场、出瞳范围、深度范围和深度分辨率。
- **眼距**：
	我们的系统假设眼睛位于距离显示像素 $f_e$ 的位置。这种放置方式确保了显示像素轴向偏移时，其观察方向不会改变；图 4 给出了相应的光线图。这使我们能够解耦深度放置和观察方向，这对将内容写入显示器时确定眼睛位置非常有帮助。这种眼睛位置还有另一个优势。如果眼睛处于不同位置，观察方向和深度放置之间的耦合会导致对于多个场景点，需要在不同轴向偏移下使用同一个显示像素。这会极大地增加我们在系统上忠实再现 3D 场景的难度。
	![[4.png]]
	**图 4. 眼睛的位置：** 我们要求将眼睛置于目镜的焦平面处，即与目镜相距 $f_e$ 的位置。这种放置方式很重要，因为它能确保显示器上轴向平移的点在眼睛处保持相同的视角 。

- **目镜焦距 $f_e$ ：** 
	选择目镜时的一个主要标准是显示器的视场。假设 $\ell_{\text{disp}}$ 是显示器和空间光调制器（SLM）宽度 / 高度中较小的值，那么多焦点显示器的视场可表示为：
	$$\text{视场} = 2 \tan^{-1} \left( \frac{\ell_{\text{disp}}}{2 f_e} \right) \tag{18}$$
	综合考虑，焦距更小是更理想的；然而，由于折射光学器件会保持系统的光学扩展量，视场的增大伴随着显示器出瞳范围的相应减小。
	另一个需要考虑的因素是显示器在可产生深度方面的工作范围。假设我们希望工作范围为屈光度（单位 D ），比如从 \[0, W\] D。目镜的焦距使我们能够确定虚拟显示器的轴向位移量。通过基本光线追迹，我们可以证明，在 $P_5$ 平面中，我们所需的总轴向位移 Z 可表示为：
	$$Z = W f_e^2 \tag{19}$$
	总轴向位移通常在几毫米的量级；例如，我们的原型设备中，目镜焦距 $f_e = 40\ \text{mm}$，工作范围 $W = 4\ \text{D}$，由此计算得 $Z = 40^2 \times 4 / 1000 = 6.4\ \text{mm}$ （对应公式应为 $Z = W f_e^2$ ，这里按原文计算逻辑呈现 ）。更小的目镜焦距会使虚拟显示器所需的轴向位移范围更小，这是有利的；然而，由于虚拟显示器轴向分辨率存在固有局限，这必然会导致工作范围内的焦平面数量减少。值得注意的是，已有多项先前的研究尝试确定多焦点显示器所需的焦平面数量；该数量可少至 5 个焦平面（当评估指标为达到满意的调节水平时 [Akeley 2004] ），多至 40 个焦平面（当评估指标为视觉 acuity 时 [Chang et al. 2018; Rolland et al. 2000] ）。我们的实现方案旨在设置 50 个焦平面，原因我们很快会列举说明。
- **立方相位板的曲率 $c_0$ 与空间光调制器（SLM）的倾斜范围：**
	如公式 (16) 所示，立方相位板的曲率对轴向位移有直接影响。曲率越大（对应 $c_0$ 越小 ），产生必要轴向平移所需的空间光调制器倾斜量 $v_0$ 就越小；然而，这会导致 $P_3$ 处的点扩散函数（PSF ）变大，从而降低深度选择的空间分辨率。
	为更好地理解这些相互制约的因素，我们首先需要确定空间光调制器进行相位调制时，斜率 $v_0$ 的限制条件。对于像素间距为 $\delta_{\text{slm}}$ 的空间光调制器，为避免混叠效应，相位梯度不能超过 $\pi / \delta_{\text{slm}}$。这就限制了：
	$$|v_0| \leq \frac{\lambda}{2\sqrt{2} \delta_{\text{slm}}} = v_{\text{max}}. \tag{20}$$
	结合公式 (16)，我们可以确定工作范围 $Z$ 的上限：
	$$Z \leq \frac{12 v_{\text{max}} f_0^3}{c_0}, \tag{21}$$
	再结合公式 (19)，可推导出：
	$$c_0 \leq \frac{12 v_{\text{max}} f_0^3}{W f_e^2}. \tag{22}$$
	一般而言，较大的 $c_0$ 值更常用，因为由此产生的曲率更小的曲面更容易制造。
	$c_0$ 的取值对于确定来自 $P_1$ 处显示器单个像素的光线在 $P_3$ 处空间光调制器（SLM）上的波前扩散情况也至关重要。如公式 (12) 所推导，该波前由立方相位函数的傅里叶变换塑造。利用傅里叶变换对的缩放性质可知，将 $c_0$ 加倍，会使点扩散函数（PSF）$h$ 在每个维度上的尺寸减小一半。因此，使用最大的 $c_0$ 值时，SLM 上的波前能量在空间上最为集中。减小该波前的空间扩散范围，进而能减少在深度不连续处产生的伪像，同时决定了我们实现深度选择性时的空间分辨率 。
- **选择中继透镜焦距 $f_0$：**
	由于中继透镜在整体设计中起着核心作用，其焦距 $f_0$ 的选择会影响显示器的多个方面。
	- **尺寸**：从结构上看，光路长度与 $f_0$ 呈线性比例关系；这意味着较小的 $f_0$ 更好。
	- **直径**：到目前为止，所有关于波前传播的分析都是基于理想透镜进行的，即假设波前很少被中继透镜切割；相应地，这就要求中继透镜具有足够大的直径。实际上，光线追迹得出的一个经验法则是，中继透镜的直径应大于像平面和傅里叶平面的孔径宽度之和。由于球面透镜的焦距不能小于其直径，这就迫使我们避免使用 $f_0$ 小的透镜。
	- **立方相位板**：由于公式 (22) 中推导的 $c_0$ 上限与 $f_0^3$ 成正比，减小 $f_0$ 会迫使我们大幅降低 $c_0$ ，而这会产生上述的负面后果，这导致应使用较大的 $f_0$ 。
	鉴于这些限制条件（因缺乏定量指标而进一步加剧 ），$f_0$ 的选择或许是最棘手的。
- **目镜的放置：**
	目镜相对于 $P_5$ 的放置位置决定了显示器的工作范围。从公式 (16) 可知，显示器上的像素可相对于 $P_5$ 虚拟平移到轴向位置范围为：
	$$\left[ -\frac{6 v_{\text{max}} f_0^3}{c_0}, +\frac{6 v_{\text{max}} f_0^3}{c_0} \right]$$
	为利用整个工作范围，目镜应放置到使整个范围更靠近透镜而非其焦平面的地方；此外，将最远轴向偏移与目镜焦平面对齐，会使该平面在眼睛看来处于无穷远。如图 5 所示，这要求目镜与 $P_5$ 的距离 $z_e$ 满足：
	$$z_e + \frac{6 v_{\text{max}} f_0^3}{c_0} = f_e \tag{23}$$
	![[5.png]]
	**图 5. 3D 内容的放置** 要在距离眼睛 $d_0$ 的深度处放置一个点，我们需要使对应于该点的显示像素相对于 $P_5$ 产生大小为 $\delta_z$ 的轴向偏移。通过基本光线追迹，我们可以推导出 $d_0$ 与 $\delta_z$ 相关的表达式，参见公式 (25) 。利用公式 (26) ，我们可以计算出空间光调制器（SLM ）上实现该轴向偏移所需的相位梯度 。
## 4.3 显示器的模拟

我们使用波动光学模型来模拟 Split - Lohmann 显示器，更具体地说，是模拟波前从 $P_1$ 一直传播到眼睛的过程。由于 $P_1$ 到 $P_5$ 构成连续的傅里叶平面，我们可以通过在每个平面上对波前进行细致离散化，利用快速傅里叶变换（FFT）来传播波前。要从 $P_5$ 传播到眼睛，我们可以再次利用傅里叶变换特性；但由于 $P_5$ 比目镜焦平面更靠近目镜，我们需要将传播后的波前与一个二次相位项相乘（参见 Goodman [2005]；第 4 章 ）。眼睛中的晶状体可根据其调节状态呈现不同焦距；我们假设视网膜是平面的，且与眼内晶状体相距 25 毫米。对于这最后一段传播，我们使用菲涅耳传播方法。在这种传播模拟中，除眼睛内的晶状体外，所有透镜都假设为理想薄透镜，直径无穷大；眼睛内的晶状体假设直径为 5 毫米。立方相位板也假设为薄型。对波前传播数值实现细节感兴趣的读者，可参考 Voelz [2011] 的相关内容 。
上述波传播过程假设了基础波的时间和空间相干性。虽然时间相干性无需担忧，但我们的显示器要求显示器发射的光具有空间非相干性。为纳入这种非相干性，我们多次传播波，在每次试验中给 $P_1$ 处的波添加随机初始相位；眼睛处的图像通过对各次试验中波的强度取平均来计算。这种添加随机相位并对所得强度场取平均的过程，模拟了空间非相干性背后的物理过程，即非空间相干点之间的随机扰动。我们的模拟代码库可在项目网站上找到 [https://github.com/Image-Science-Lab-cmu/SplitLohmann] 。
除了波动模型，我们还在 Blender 中构建了一个基于光线追迹的设备模拟器。该模拟器采用真实的光学器件（实际上，就是原型设备中使用的整套透镜），并考虑了包括立方相位板在内的各种光学元件厚度的影响；不过，难以用几何光学建模的相位型空间光调制器（SLM），是作为微镜阵列来实现的。感兴趣的读者可在补充材料中找到这个已配置好场景的 Blender 模型 。
## 4.4 内容适配
为显示 3D 场景，我们的系统将强度图像 $t(\alpha, \beta)$ 和深度图像 $d(\alpha, \beta)$ 作为输入，其中 $\alpha$ 和 $\beta$ 对应于眼睛所张角度的正切值$^{[2]}$。因此，像素 $(\alpha_0, \beta_0)$ 处的强度 $t(\alpha_0, \beta_0)$ 对应于 3D 场景点 $d(\alpha_0, \beta_0$)$[\alpha_0, \beta_0, 1]^T$。
> [!注释 2 ：]
> 角度的正切值所对应的空间位置正好与透视相机像平面上的位置相对应；因此，在描述图像时，这是很自然的一种选择 。

图 5 详细展示了目镜和眼睛相对于 $P_5$ 平面的放置情况，以及如何计算虚拟显示位置以获得特定深度的光线图。如公式 (23) 所示，目镜放置在距离 $P_5$ 为 $z_e$ 的位置。正如图 4 中所提及的，眼睛放置在距离目镜 $f_e$ 的位置，这确保了显示像素的轴向偏移不会改变其观察方向。因此，我们需要确保强度 $t(\alpha_0, \beta_0)$ 显示在 $P_1$ 处显示器上的 $(f_e\alpha_0, f_e\beta_0)$ 位置；需要注意的是，该计算忽略了非期望偏移的影响，而我们很快会说明，这种偏移可变得极小 。
要在距离眼睛 $d_0 = d(\alpha_0, \beta_0)$ 的深度处放置同一个点，我们需要使该点相对于基准平面 $P_5$ 产生位移 $\delta_z$，满足：
$$\frac{1}{z_e - \delta_z} - \frac{1}{d_0 - f_e} = \frac{1}{f_e} \tag{24}$$
该表达式可由图 5 所示的光线图推导得出，化简后为：
$$\delta_z = z_e - \frac{(d_0 - f_e)f_e}{d_0} \tag{25}$$
为产生这种轴向偏移，我们可利用公式 (16) 计算对应于该像素的空间光调制器（SLM）斜率参数 $v_0$：
$$v_0 = -\frac{\delta_z c_0}{6 f_0^3} \tag{26}$$
相应地，考虑到 $P_3$ 平面上的 $xy$ 翻转，我们需要确保空间光调制器上的图案在位置 $(-f_e\alpha_0, -f_e\beta_0)$ 处具有公式 (26) 中 $v_0$ 对应的斜率 。
- **深度图量化的必要性：**
	已知输入深度图 $d(\alpha, \beta)$，很难不去做通过将公式 (25) 中的 $d_0$ 替换为 $d(\alpha, \beta)$ 来计算轴向偏移图 $\delta_z(\alpha, \beta)$，随后利用公式 (26) 计算相位型空间光调制器（SLM）的斜率图 $v_0(\alpha, \beta)$ 。此时，我们可利用公式 (13) 为 SLM 创建相位图像 $\phi(x_3, y_3)$：
	$$\phi(x_3, y_3) = \frac{2\pi}{\lambda} (x_3 + y_3) v_0 \left( -\frac{x_3}{f_e}, -\frac{y_3}{f_e} \right)$$
	然而，这种相位图案无法正常工作，因为其梯度并非我们想要的的梯度；具体来说：
	$$\frac{\partial \phi}{\partial x_3} = \frac{2\pi}{\lambda} v_0 - \frac{2\pi}{\lambda} (x_3 + y_3) \frac{1}{f_e} \frac{\partial v_0}{\partial x_3}$$
	第二项会产生严重错误的相位梯度，进而导致立方相位板出现错误的二维平移。
	为解决这一问题，我们采用一种简单的启发式方法：在屈光度空间中对深度图 $d(\alpha, \beta)$ 进行量化。鉴于自然场景的深度图是分段平滑的，对其进行量化可使其变为分段恒定的。分段恒定的图像，除不连续处外，梯度值为零；这种简单的修正方法可确保相位梯度的第二项在大多数位置为零。对于论文中的结果，我们在显示器的工作范围内（通常为 25 厘米到无穷远，或 $[0, 4]$ 屈光度 ），用 50 个等距值对场景进行量化，这会产生 0.04 屈光度的量化误差。我们选择 50 个量化级别，是基于先前的研究成果 [Chang et al. 2018]，该研究确定了当眼睛聚焦于某一点时，为维持视觉敏锐度所需的焦平面数量 。
	![[6.png]]
	**图 6. 深度图量化** 对于 (a, b) 中所示的场景，我们呈现了在推导空间光调制器（SLM）相位函数之前对深度图进行量化（d）和不进行量化（c）的模拟结果。(c, d) 中的列对应眼睛聚焦于 4 屈光度（左）和 3 屈光度（右）的情况。如图 (d) 所示，使用量化可产生真实的聚焦和散焦提示。相比之下，在未进行量化时，我们仅能观察到深度图局部恒定的物体（如车辆前部）有正确的聚焦提示。即使是散焦提示，例如 (c) 中建筑物轮廓的散焦提示也是错误的。这是因为空间光调制器使立方相位板沿两个轴产生了不均匀的偏移；这会导致在这些点上产生椭圆相位延迟，使眼睛无法聚焦于它们。叠加在图像上的箭头表示兴趣点，绿色编码表示正确的（散）聚焦提示，红色编码表示错误的（散）聚焦提示。（鸣谢：“SimplePoly City” 3D 场景由 Unity 资源商店的 “VenCreations” 提供 ）
	图 6 展示了对深度图进行量化和未进行量化时的模拟结果。在未进行量化的情况下，眼睛仅能聚焦于深度图局部恒定的区域，比如汽车和卡车的前部。对于场景中深度平滑变化的部分，如道路和建筑物立面，空间光调制器（SLM）所引起的偏移在 $x$ 轴和 $y$ 轴上不再相等；由此产生的调制不再是二次的，因此，眼睛无法聚焦于这些部分 。
算法 1 中提供了该过程的伪代码。此过程近乎解析，计算开销小。因此，我们无需复杂的计算平台，甚至无需经过优化的实现，就能轻松实现交互式应用。第 5 节和补充视频展示了这类交互式场景 。
![[表1.png]]
## 4.5 SLM 上不连续现象的影响
我们要解决一项对本研究至关重要的问题：我们的系统在深度放置的空间分辨率方面，具备怎样的能力？在目前呈现的分析中，有两项观察结果限制了深度选择性。第一项是假设与显示器上一个像素相关的大部分波前，仅与空间光调制器（SLM）上的单一斜率相关（或者具体而言，不会分散到多个斜率上）；如前所述，由于立方相位板在 $P_2$ 处使光发生扩散，实际情况往往并非如此。第二项是在设计相位函数时，将深度图设为分段恒定以避免产生不期望的梯度；不过，只要场景中有足够数量的焦平面 [Chang 等人，2018]，这就不算严格的限制条件。我们现在将详细研究深度不连续处周围的伪像情况 。
![[7.png]]

**图 7. 深度不连续处伪像的分析：** 我们使用由点光源构成的场景，分析跨深度不连续处的光泄漏效应$^{[3]}$。（从左至右 ）：叠加有点光源位置的场景深度图，黑色部分对应屈光度 0 D 的深度，灰色对应 4 D 的深度；在深度图上叠加 $P_3$ 平面观察到的图像，粉色表示跨深度不连续处泄漏的光；眼睛聚焦于 0 D 时场景的图像；聚焦于 4 D 时的图像。在（a）中，我们研究距不连续处的距离对泄漏的影响，（b）研究深度不连续处方向的影响。当跨不连续处存在显著光泄漏时，我们观察到以下情况：（i）当泄漏显著时，点开始在两个深度上都呈现聚焦状态；（ii）散焦模糊不再是圆形的；（iii）泄漏效应具有高度各向异性。右侧的图表展示了未泄漏光的比例随距离（a）和方向（b）变化的函数关系。我们观察到，当点距离不连续处约 25 微米时，少于 50% 的光发生泄漏 。
> [!注释3：]
> 光泄露效应：
> 指的是光跨越深度不连续界面，非预期地从一个深度区域泄漏到另一个深度区域，使成像出现焦点异常（同一光点在两个深度都看似聚焦 ）、散焦模糊变形（不再是圆形 ）、各向异性（不同方向泄漏程度不同 ）等问题，影响显示的深度选择性与成像质量 。

图 7 在模拟中考虑了一组与深度边缘距离不同的点。对于距离边缘足够远的点，由于它们主要受单个相位斜坡调制，理论结论成立；当眼睛聚焦于选定深度时，点能清晰分辨，失焦时则出现散焦模糊。然而，当立方点扩散函数（PSF）跨深度边缘分割时，我们观察到以下情况：
- **在两个深度上聚焦**：该点会在其波前相互作用的两个深度上聚焦，聚焦光斑的相对强度取决于重叠量。具体而言，当点距离边缘约 25 微米时，泄漏能量与期望深度的能量相等；当点距离边缘约 150 微米时，泄漏能量要小 10 倍 。
- **散景失真**：散焦模糊核呈现失真形状，可能是由于我们新产生的两个聚焦光斑之间的干涉所致 。
- **依赖于不连续处的方向**：立方板的散焦模糊具有各向异性；因此，深度不连续处的方向在决定发生多少泄漏方面起着重要作用。图 7 (b) 展示了这样一个示例。在最有利的配置中，即使点紧邻不连续处，也不会有泄漏 。
虽然这些伪像对于点光源可能会分散注意力，但对于具有密集纹理的场景而言，它们的影响没那么显著。在我们测试过的数十个场景中，发现这些伪像最多只是无害且略微让人分心。不过，在某些情况下，当同一纹理的多个副本可能出现时，聚焦伪像可能会分散注意力。图 8 给出了一个示例。
![[8.png]]
**图 8. 大深度不连续处的伪像** 我们呈现了一个在玩具面部附近存在大深度不连续的场景的模拟结果。红色方框标示出了可见伪像的大深度不连续区域。（鸣谢：“The Daily Dweebs” 3D 场景由 Blender Studio 和 Hjalti Hjalmarsson 提供 ）
## 4.6 非期望横向偏移的影响

如先前所讨论并在公式 (17) 中描述的那样，Split - Lohmann 显示器还会产生非期望的横向偏移。在讨论减少该偏移的潜在方法之前，有必要了解其偏移规模。例如，对于 GAEA 空间光调制器（SLM），像素间距为 $\delta_\mathrm{SLM}=3.74\ \mu\text{m}$，因此，当 $\lambda = 532\ \text{nm}$ 时，公式 (20) 中的 $v_\mathrm{max}$ 等于 0.05 。假设焦距 $f_0 = 100\ \text{mm}$、$f_e = 40\ \text{mm}$，工作范围 $W = 4\ \text{屈光度}$，由公式 (22) 可得 $c_0 = 0.09375\ \text{m}^2$ 。据此，利用公式 (17) 可计算出最大横向偏移为 $80 \mu\text{m}$，约为显示器的 10 个像素。此外，横向偏移对 $v_0$ 的二次依赖关系还意味着，大多数深度不会出现如此大的偏移；也就是说，虽然利用 SLM 上最大斜率得到的 0 屈光度（ 0 D ）和 4 屈光度（ 4 D ）内容会出现这样大的偏移，但例如 1 屈光度（ 1 D ）到 3 屈光度（ 3 D ）之间的内容，只会出现小于 $20 \mu\text{m}$（或 2.5 个像素 ）的偏移 。
我们可以通过牺牲可选择的深度平面数量来进一步减小横向偏移。由于深度选择性源自空间光调制器（SLM）上的斜率，一个 8 位的 SLM 可在 SLM 斜率方面提供多达 256 种独特选择。这有些过剩，因为要维持聚焦清晰度并满足调节线索，我们很少需要超过 40 个左右的焦平面。因此，我们可以使用一个 $c_0$ 更小的立方相位板，这会增大工作范围；例如，将 $c_0$ 的值减半至 $0.047\ \text{m}^2$，可使工作范围 W 加倍至 8 屈光度（ 8 D ）。由于我们只需要这个工作范围的中间 4 屈光度（ 4 D ），我们可以选择仅使用 SLM 一半的倾斜能力，考虑到更小的 $c_0$ 后，这会使最大横向偏移减小一半，这样横向偏移在每个轴向上就变为 40 微米。但这会带来立方相位板产生更广泛模糊的代价，降低深度的空间选择性。论文中的模拟和实际结果均是在 $c_0 = 0.0193\ \text{m}^2$ 情况下获得的；这会将最大偏移减小到约 10 微米，人眼无法察觉，且深度平面数量变为 52 个 。
## 4.7 Split - Lohmann 显示器的特性
我们现在结合用于表征近眼显示器的指标，简要讨论 Split - Lohmann 显示器的特性。
- 视场和出瞳
	视场由有机发光二极管（OLED）宽度和目镜焦距决定，如公式 18 所述。对于我们的实验室原型，对角线视场为 25° 。
	与其他多焦点显示器类似，出瞳大小主要由所用透镜的数值孔径以及任何限制光阑决定；由于使用了 4f 中继系统，是后者限制了我们的原型。由于空间光调制器（SLM）引起的偏移，限制光阑会略有减小，且这种偏移与深度相关；在 $P_5$ 处轴向分辨的点不会看到光阑减小，而当偏离 $P_5$ 时，出瞳会逐渐减小。忽略这种偏移的影响（我们预计该影响较小，因为未使用 SLM 的全部弯曲能力 ），可按以下方式计算出瞳大小：
	$$\text{4f系统光阑直径} \times \frac{f_e}{f_0}$$
	其中，因子 $f_e/f_0$ 反映目镜引起的缩放。对于我们的实验室原型，出瞳大小为 5 毫米（ $f_e = 40\ \text{mm}$，$f_0 = 100\ \text{mm}$，$\text{光阑直径} = 12.5\ \text {mm}$ ） 。
	值得注意的是，使用焦距更小的目镜可轻松增大视场。然而，由于折射光学的 étendue（光学扩展量）不变性，视场的这种扩大将导致出瞳大小相应减小。我们可通过在 4f 中继系统中使用数值孔径更高的光学元件来抵消这一影响；例如，使用 50 毫米或 30 毫米的透镜，这会使出瞳在各个维度上分别加倍或变为三倍 。
- **工作范围和深度分辨率：**
	显示器的工作范围是主要设计目标之一，我们的显示器可轻松达到多焦点显示器通常配置的典型 4 屈光度（ 4 D ）范围。一般来说，大工作范围需要大的轴向移动或更小的目镜焦距。从公式 21 可知，使用性能更强的空间光调制器（SLM，更大的 $v_\mathrm{max}$ ）、更大的 $f_0$ 或性能更强的立方相位板（更小的 $c_0$ ），可实现更大的工作范围。因此，原则上，我们能够实现与儿童相关的 20 屈光度（ 20 D ）工作范围 [Chen 等人，2000]；实际上，如果我们利用 SLM 的整个倾斜范围，我们的原型机就可达到这一范围 。
	深度分辨率由我们在空间光调制器（SLM）上实现相位斜坡的精度控制。大致近似来看，这受限于对 SLM 进行寻址时可用的量化级别数量，通常为 8 位；这意味着我们最多可显示 255 个深度平面。大多数应用不需要这么多选择；不过，正如 4.6 节所述，我们也可以通过牺牲深度分辨率来减小横向偏移（但还会以立方相位板泄漏增加为代价 ） 。
![[9.png]]
**图 9. 我们实验室原型的示意图** 如需更详细的示意图及组件列表，请参见补充材料中的图 S4 。
（[[SplitLohmann_SIGGRAPH23-supp.pdf#page=4&selection=160,0,160,68|SplitLohmann_SIGGRAPH23-supp, 页面 4]]）

# 5 评估
我们介绍 Split - Lohmann 显示器实验室实现的详细信息，呈现详述该系统在各类场景中性能的结果，以及与相关先前研究工作的对比。
## 5.1 硬件实现
我们通过搭建一个概念验证硬件原型，对 Split - Lohmann 显示器进行实验评估，其示意图如图 9 所示。详细的组件列表可在补充材料的 S2 节中找到 。（[[SplitLohmann_SIGGRAPH23-supp.pdf#page=4&selection=162,0,164,37|SplitLohmann_SIGGRAPH23-supp, 页面 4]]）
- **硬件细节：**
	所使用的 OLED 是对角线为 1.03 英寸的微型 OLED，分辨率为 2560×2560，像素间距 $\delta_\text{OLED} = 7\ \mu\text{m}$ 。空间光调制器（SLM）采用的是 Holoeye GAEA - 2 纯相位反射式 SLM，分辨率为 2464×4000，像素间距 $\delta_\text{SLM} = 3.74\ \mu\text{m}$ 。SLM 的较小面积决定了显示器内容的限制光阑，进而决定了视场。我们使用了一个 40 毫米的目镜，可提供约 25° 的对角线视场。
	在光学方面，中继透镜为消色差双胶合透镜，焦距 $f_0 = 100\ \text{mm}$ 。立方相位板为定制元件，通过减材制造工艺制备（即使用激光雕刻出所需形状 ）制成。它在直径 12 毫米的范围内进行制造，厚度参数 $c_0 = 0.0193\ \text{m}^2$ ，所用材料的折射率为 $1.46$ 。在这些设置下，相位板的最大凹陷为 $50 \mu\text{m}$ ，这也是制造工艺的极限 。
- **工作范围与深度量化：**
	我们的空间光调制器（SLM）可实现的最大倾斜，使立方相位板在两个焦点间的最大位移为 $6.952$ 毫米；利用公式（19）、（20）和（21），可估算出最大工作范围 $W = 27.535$ 屈光度。然而，正如 4.6 节所讨论的，我们仅使用 4 屈光度的工作范围，这会将非期望的横向偏移减小到约 $10.293$ 微米。鉴于有机发光二极管（OLED）7 微米的像素间距，这种位移几乎无法被察觉。最后，如算法 1 所述，所有结果均是在以屈光度衡量的深度图被均匀量化为 50 个区间的情况下获得的 。
- **色彩处理：**
	我们使用光谱仪测量 OLED 色彩通道，发现红色通道光谱峰值在 $619nm$、绿色通道在 $530nm$、蓝色通道在 $461nm$；各通道的半高全宽（FWHM，full - width half max ）分别为 $28nm$、$31nm$ 和 $17nm$ 。除色彩序列结果外，所有结果均是在将空间光调制器（SLM）伽马曲线针对绿色通道优化的情况下采集的；选择这样做是因为绿色在自然成像中占主导地位。在此操作模式下（我们称之为 “绿色模拟” ），三个色彩通道均由针对 OLED 绿色通道峰值波长优化的单一 SLM 相位掩模同时照明。关于色彩处理更精确的评估，将在本节后续内容呈现 。
- **使用观测相机采集结果：**
	本文呈现的结果是使用尼康 Z5 相机采集的，该相机配置 $25mm$ 焦距、$F/5.6$ 光圈，在 $55mm$ 焦距下运行。对于焦点堆叠结果，我们使用 ISO 100，并远程控制镜头的焦点设置，曝光时间通常为 1 - 3 秒。对于补充材料中的视频结果，我们使用相机的视频模式，ISO 通常在 $3200$ 左右，帧率为 $24fps$。在所有这些操作中，相机完全与显示器的显示同步运行，无需任何同步装置 。
## 5.2 静态虚拟现实场景
我们首先呈现静态虚拟现实（VR）场景的结果。
- **散景（Bokeh）**
	我们通过实验展示了不同深度白点的散景效果，如图 10 所示。我们使用了一个由 49 个点组成的 3D 场景，这些点在 0 到 4 屈光度（D）的范围内均匀采样。我们可以观察到：（a）离焦光点的模糊核保持自然的圆形，而对焦光点保持清晰；（b）随着内容深度进一步偏离对焦距离，圆形模糊核的尺寸会增大 。
	
	![[10.png]]
	**图 10. 散景** 为表征显示器产生的聚焦和散焦模糊，我们使用（a）中所示场景，该场景包含一个稀疏的 7×7 网格规模的 4 像素 × 4 像素大小的光点阵列。深度图与该场景相关联，是一个跨越 0 屈光度（D）到 4D 范围的分段常数。我们用于空间光调制器（SLM）的最终相位掩模如右侧所示。在（b）中，我们展示了用观测相机在三种不同聚焦设置（最远的 0 D、中间的 2 D 和最近的 4 D ）下采集的图像。我们观察到，聚焦光点清晰锐利，而其他光点的散焦模糊随深度（以屈光度衡量 ）呈线性增加。观察到的散景大体为圆形；与圆形的偏差可归因于 SLM 引起的偏移以及光学组件的装配误差。此结果是在绿色通道采集并以灰度可视化的 。
- **空间分辨率和深度分辨率：**
	为了表征我们原型机的空间分辨率和深度分辨率，我们在设备上显示分辨率测试图，并在图 11 中报告结果。我们将相机焦距固定在 0 屈光度（D），并将内容置于不同深度，使用调制传递函数（MTF）表征所得图像中的散焦情况。当场景置于 0.125 D 处时，我们能清晰观察到差异，且即使在间距为 0.0625 D 时，调制传递函数（MTF）也有所不同。鉴于我们系统的工作范围为 4D，这表明我们的显示器能够显示至少 32 到 64 个焦平面。当内容处于 0 D 时，调制传递函数（MTF）表征了设备的空间分辨率，因为此时相机对焦于内容。我们在有机发光二极管（OLED）显示平面上观察到，在 $35\  lp/mm$ 的空间频率下，调制传递函数 30（MTF30 ）对应的空间周期为 4 个像素，仅比显示器的原生分辨率差 2 倍$^{[4]}$ 。
	
	
	![[11.png]]
	**图 11. 深度分辨率表征** 我们显示一个 USAF 分辨率测试板，从 1 屈光度（D）开始，以更小的增量逐步靠近 0D，呈现于不同深度。相机始终对焦于 0D，（a）中展示了随内容深度变化采集到的图像的局部放大图。正如预期，当靠近 0D 时，散焦模糊减轻；即便内容处于 0.125D 时，仍可清晰区分；这也反映在（b）所示的调制传递函数（MTF）图中。这表明我们的系统能够分辨间隔为 0.125D 的焦平面，换算下来，在 4D 的工作范围内可呈现 32 个焦平面。MTF 图中的空间频率对应有机发光二极管（OLED）显示平面；此处，35 线对每毫米（lp/mm）的频率下，当对焦于 0D 处的内容时，可达到 MTF30（调制传递函数为 30% ），对应 4 个像素的空间周期，仅比显示器的原生分辨率差 2 倍 $^{[4]}$。
> [!注释 4 ：]
	> **原生分辨率（Native Resolution）**：显示器本身的像素排列密度决定的固有分辨率，可理解为显示器能 “原生” 呈现的最精细像素级细节。其中 “2× 像素间距” 对应一个线对的物理长度，因为一个线对包含黑、白各一个像素宽度。
	> 注意到 35 lp/mm 的空间频率对应的空间周期为 1/(35 lp/mm) ≈ 28.6 μm ，对应 4 个像素，所以说显示器的原生分辨率是设备分辨率的 2 倍
	
- **与时间复用多焦点显示器的对比：**
	正如我们在第 4 节中讨论的，Split - Lohmann 显示器中像差的主要来源之一，是跨深度不连续处的光泄漏。为了分离由这一因素导致的伪像，我们将其与在相同硬件上实现的时间复用型同类显示器进行对比。具体而言，对于时间复用的结果，我们将场景划分为 50 个不重叠的图像，每个图像对应不同的深度。我们采集 50 幅图像（针对观测相机的每个聚焦设置 ），依次遍历与每个焦平面对应的图像；对于这些图像中的每一幅，空间光调制器（SLM）会显示一个具有恒定梯度的全局相位斜坡，以将内容置于所需焦平面。采集到的图像通过数字相加来模拟视觉暂留效应，并针对观测相机的两种不同聚焦设置，在图 12 中进行可视化呈现 。
	图 12 表明，Split - Lohmann 显示器与其时间复用型同类显示器的图像整体质量几乎没有差异。仔细观察确实会发现在深度不连续处附近有一些极细微的重影伪像。这与我们在图 8 中的模拟结果一致。由于 Split - Lohmann 和时间复用的结果均来自同一硬件，该结果分离出了纯粹由单次拍摄（单帧 ）实现方式导致的伪像；换句话说，它对图 2（c）和（d）所示的设置进行了对比 。
	![[12.png]]
	**图 12. 与时间复用多焦点显示器的对比** 为分离 Split - Lohmann 显示器中的光泄漏伪像，我们将其与在相同硬件上实现的时间复用型同类显示器进行对比。时间复用结果是通过按序显示内容获得的，即利用空间光调制器（SLM）上的全局相位斜坡，每次显示一个焦平面；随后将采集到的照片进行数字相加。针对相机的每个聚焦设置，重复此过程。拍摄这些照片所需的高 ISO、长曝光会导致出现一些热像素。Split - Lohmann 显示器的结果在深度不连续处存在伪像，我们在局部放大图中用蓝色箭头突出显示，且在绝对差值图像（为便于可视化增强了 3 倍 ）中极易看到。白色箭头所示为两种方法均存在的 SLM 相位扭曲伪像。两行系统间的峰值信噪比（PSNR）和结构相似性（SSIM）值已叠加显示。需注意，这些值会受采集照片中的测量噪声影响。此结果是在绿色通道采集并以灰度可视化的。（鸣谢：3D 素材由 TurboSquid 网站的 “3DinHD” 提供 ）
- **场序彩色与同时彩色的对比：**
	当处理多色输入时，相位型空间光调制器（SLM）的使用总会导致色差。我们评估两种彩色模式的性能：其一为**场序彩色**，在此模式中，我们对红、绿、蓝三个颜色通道进行时间复用，为每种颜色配置正确的 SLM 伽马曲线，以确保相位调制的最大保真度；其二为**场同时彩色**，在此模式中，OLED 同时显示三个颜色通道，且 SLM 配置为针对绿色优化的伽马曲线。对于场序彩色，调整 SLM 的伽马曲线即可满足需求 —— 因为伽马曲线的变化会改变**光程延迟**，使 SLM 的 0–255 输入值针对校准波长映射为 0–2π 的相位延迟；但这需要在**视觉暂留**时间内快速显示三幅单色图像（红、绿、蓝各一幅 ）。对于场同时彩色，SLM 仅针对绿色波长优化，红、蓝波长会经历**错误的相位斜坡**。具体而言：为绿色波长 $\lambda_g$ 设计的相位梯度 $v_0$，在波长为 $\lambda$ 的光（红或蓝光 ）照射时，实际相位梯度会缩放为 $v_0\lambda_g/\lambda$ 。因此，与期望深度相比，红光（波长更长 ）会聚焦在稍远的位置，蓝光（波长更短 ）会聚焦在稍近的位置，而绿色通道可正确聚焦。
	图 13 和图 14 探讨了两种彩色模式之间的差异，前者采用高对比度场景，后者采用自然场景。从图 13 中，我们可以观察到每种颜色在其自身的伽马曲线下解析效果最佳，且在针对正确的延迟曲线时，峰值达到最大。考虑到绿色波长与红蓝光波长之比为 $\lambda_g/\lambda_r = 0.86$ 和 $\lambda_g/\lambda_b = 1.15$ ，峰值的差异并没有我们预期的那么大；这可能是由于光学装置中的对准误差所致，而这种误差可能会降低整体性能。从图 14 中，无论从定性还是定量角度，我们都观察到两种彩色模式生成的图像之间具有高保真度。
	两种色彩模式所得结果的相似性，促使我们在本文后续结果中，选择**场同时彩色**作为操作模式。具体而言，该模式可避免对有机发光二极管（OLED）和空间光调制器（SLM）进行**高帧率控制**—— 若要实现高帧率控制，需为这两个设备开发定制化控制板。此外，该模式还能让我们在**几乎无需额外实现成本**的情况下，展示交互式 VR 场景。
	![[13.png]]
	**图 13. 不同 SLM 伽马曲线下的聚焦对比**  图（a）中的场景用于测试系统聚焦随波长的变化规律。我们在空间光调制器（SLM）上采用不同的伽马校正曲线，在 0 屈光度（D）处显示三条彩色线条。可以观察到，每种颜色的线条在对应的伽马曲线下最为锐利。在图（b）中，我们沿 y 方向对其强度取平均值，绘图颜色与实际颜色通道相对应。可见，每个峰值在正确的伽马曲线下达到最大值。这一结果表征了**场序彩色**（会选取最佳伽马曲线对应的峰值）与**场同时彩色**（对应某一行的峰值）之间的色彩性能差异。
	![[14.png]]
	
	**图 14. 色彩模式对比**  与图 13 类似，我们在此对比**场序色彩模式**与**场同时色彩模式**，测试场景扩展至 0 屈光度（D）到 4 D 的深度范围。从峰值信噪比（PSNR）和结构相似性（SSIM）指标可见，两种模式采集的图像整体保真度较高。两种色彩模式的**绝对差值图像**（增强 10 倍后）凸显了红、蓝通道的明显误差；此外还存在**光子噪声**，表现为原始图像的 “去饱和版” 视觉效果。（鸣谢：Blender Studio 的 Piotr Krynski 提供 “Scanlands” 3D 场景 ）
- **视差：**
	多焦点显示器中呈现的虚拟场景确实满足视差线索，至少在眼盒范围内是如此。图5 和补充视频展示了这种效果。然而，我们的显示器既未通过内容优化[Mercier等人，2017年；Narain等人，2015年]，也未通过光学设计[Chang等人，2020年]来实现任何遮挡线索。这是我们显示器的一个局限性；我们将在第6节中更详细地讨论这一点。
	![[15.png]]
	**图15. 观察视差** 我们展示一个在场同步色彩模式下、具有4D工作范围的场景。图像是在两种不同的对焦设置（ 0.25 米和 ∞ 米 ）下拍摄的。相机水平移动了约 3 毫米，我们观察到更靠近相机的场景点移动幅度更大；补充材料中有展示该结果的视频。我们叠加了虚线和箭头作为位置参考——绿色用于表示无穷远处的内容，白色用于表示 0.25 米处的内容——以更好地突出视差的程度。（鸣谢：3D 场景由 CGTrader 平台上的 “3D-ModelsArtist” 提供 ）
- **与焦面显示器的对比：**
	如第2节所述，焦面显示器[Matsuda等人，2017年]是与我们的理念最为接近的竞品，因为两者都试图实现一种焦距随空间变化的透镜。这两种设备在本质上存在显著差异，难以进行公平或直接的对比。然而，在同一场景下对比结果，对于理解结果质量的差异及其背后的原因，具有一定的说明意义。
	图16展示了焦面显示器和Split - Lohmann显示器原型的焦栈结果。焦面显示器的结果来自其论文[Matsuda等人，2017年]；我们使用了在类似聚焦设置下拍摄的同一场景。两个原型都经过优化，可在4屈光度（D）的工作范围内、以相似的视场运行，且均在场同时彩色模式下运行。焦面显示器的结果是三个表面经时间复用合成到一幅图像中；我们的结果则未进行任何时间复用。
	总体而言，我们观察到 Split - Lohmann 方法在场景的整个工作范围内具有更出色的聚焦性能，且伪像更少。造成这种情况的主要原因在于我们使用各自空间光调制器（SLM）的方式。焦面显示器将 SLM 用作实现空间变化焦距的主要单元；如今，商用 SLM 相对较低的屈光力成为了这种设计的显著瓶颈，即便场景分布在三个焦面上也是如此。另一方面，Split - Lohmann 方法利用 SLM 使光线倾斜（在我们的原型中，就光线倾斜而言，我们甚至都没有将 SLM 推至其极限 ）；深度定位方面的实际繁重工作是由立方相位板完成的，这些立方相位板比相位型 SLM 厚得多（50μm ）。性能上的差异也可归因于我们的是台式原型系统，而焦面显示器是紧凑的实现方案。补充材料展示了相同的结果，但那是在模拟环境中。
	![[16.png]]
	**图 16. 与焦面显示器的定性对比[Matsuda 等人，2017]**  两种技术的结果均来自真实硬件原型，焦面显示器的结果重现自其论文。我们观察到，Split - Lohmann 方法呈现出更清晰的内容、更自然的散焦模糊，同时可观测到的噪声极小。（鸣谢：“SimplePoly City” 3D 场景由 Unity 资源商店的 “VenCreations” 提供 ）
- **场景展示集：**
	图17展示了一组场景。所有场景都具备4D工作范围，且是在场同步色彩模式下拍摄的。这些场景的焦栈（Focal stacks）可在补充视频中查看。
	![[17.png]]
	**图17. 静态虚拟现实（VR）结果展示集** （鸣谢：左侧的RGBD内容由Middlebury 2014立体数据集提供[Scharstein等人，2014] ；中间的RGBD内容由DeepFocus数据集提供[Xiao等人，2018b] ；右侧的Sintel 3D场景由Blender Studio提供 ）
## 5.3 视频与交互式虚拟现实（VR） 
Split - Lohmann 显示器在将 RGBD 内容分别映射到 OLED 和相位空间光调制器（SLM）显示的纹理与相位图案方面，计算量极低。这使得展示视频和交互式虚拟现实场景（如 3D 游戏）变得轻松。图 18 展示了一段视频和一个交互式 3D 游戏的静态画面；补充材料中包含这两个场景的视频记录。能够以极小的额外开销轻松移植内容，同时保持高视觉质量，这是我们技术的显著优势之一。
![[18.png]]
**图18. 视频及交互式虚拟现实（VR）结果展示集** （左）我们展示了在原型设备上播放流式电影时，经手动调整焦距拍摄的三帧画面。绿色小图显示了每张图像中的对焦区域。我们展示了三个时间点 $t_0 < t_1 < t_2$ 的帧。在这段视频中，相机沿光轴向前移动，因此前一帧中失焦的点会在后续对焦。例如，香蕉在 $t_0$ 时失焦，在 $t_1$ 时对焦。（右）一个玩家玩《我的世界》（Minecraft）游戏的交互式场景。和之前一样，我们在拍摄游戏画面时手动调整相机焦距。在 $t_0$ 时，玩家静止站立，我们的相机对焦在近处的白色植物上。然后相机在 $t_1$ 时切换焦距。玩家接着在 $t_2$ 时继续向对焦距离区域移动。（鸣谢：（左）“Interior Kitchen” 3D 场景由 Blender Market 的 “Entity Designer” 提供，动画由 Mohamad Zeina 提供；（右）《Craft》3D 游戏由 Michael Fogleman 提供 ）
# 6 讨论 
我们将探讨所提出的 Split - Lohmann 显示器的一些特性，包括源于我们设计和实现各方面的局限性。
- **散焦模糊的泄露与内容优化：**
	多焦点显示器通常受限于焦平面的透明性问题，即某一深度的内容无法遮挡来自其他深度的光线。这一问题通常表现为，由于较远位置的散焦模糊透过离眼睛更近的内容发生泄露，导致遮挡线索变弱。我们的技术是多焦点显示器的一种 “基础” 实现方式，因此也继承了这些局限性。
	存在一些内容优化技术 [Choi 等人，2019；Mercier 等人，2017；Narain 等人，2015；Xiao 等人，2018a]，旨在解决此类问题。这类技术会在多焦点显示器的真实成像模型下，联合优化不同焦平面上显示的内容，从而使眼睛聚焦于不同深度时所看到的图像，具备真实的散焦和遮挡线索。不变的是，这需要能够在同一显示像素的多个焦平面上呈现内容，对于深度边缘附近的像素而言，这点尤为关键。除非我们采用时间复用，否则这是我们当前系统无法实现的能力；例如，焦面显示器在对多个表面进行时间复用时，就能借助内容优化获益。鉴于内容优化与我们所实现的硬件设计具有互补性，我们确实认为，一旦允许采用时间复用的内容，这会是一种可行的方法，且能够整合到我们的系统中。
- **聚焦区域的清晰度损失：**
	仔细观察我们的实验室原型结果（例如图17 ），与 OLED 显示器上显示的图像相比，聚焦区域的清晰度会略有损失。这很可能是由于系统校准误差造成的；具体来说，立方波前的两个副本之间的任何非对角位移，都会产生一种非球面波前，眼睛或相机无法将其聚焦清晰。这或许可以通过精心的组装和校准来解决。模糊的第二个来源是目镜引入的像差（在视场的边缘区域可见 ）。这有可能通过空间变化校准来解决，即针对每个深度和空间位置，识别不同斜率和方向的梯度。
- **空间光调制器（SLM）产生的伪像 ：**
	使用相位型空间光调制器（SLM）会产生若干伪像。在硬件实验结果中，我们观察到两类主要影响：相位扭曲伪像和未调制光。 
	相位扭曲伪像源于相位型 SLM 引入的相位延迟固有的平滑特性 ；因此，当出现从陡峭的 $2\pi$ 到 $0$ 的相位跳变时，SLM 会生成经过平滑处理的相位延迟，进而产生可见伪像，显露出扭曲轮廓。图 12 中国际象棋棋子的示例可体现这一点，插图里的白色箭头对其进行了标注。解决该问题的方法有多种，包括对扭曲位置进行时间复用，让伪像经平均后消失。在我们的实验结果中，这种影响较为细微，因此我们选择暂不解决。
	相位型 SLM 还存在非理想的填充因子，会导致未调制光产生 ；在我们的原型中，约 5% 的光属于未调制光。未调制光会在 $P_5$ 平面上形成 OLED 的图像。这类影响在高对比度场景中可被观测到，但在内容密集的场景中过于细微，难以察觉 。
- **提高深度的空间选择性：**
	限制我们精确选择深度（尤其是在不连续区域附近）的主要因素，是双三次相位板所产生的点扩散函数（PSF）的大小 。改善这一情况的一种方法是突破双三次相位板的限制，转而优化单个相位板，甚至是一对相位板。原则上，我们可以使用 Heide 等人 [2016] 提出的优化框架来设计这样一对相位板 。这种方法的一个优势在于，我们能够突破对两块相位板仅进行对角位移调整的局限，进而利用傅里叶平面上所有可用的方向范围 。
- **紧凑型实现方案 ：**
	Split - Lohmann 显示器当前的实现方案缺乏便携性，不过对于眼科和机器人手术应用而言，或许这种程度的便携性已足够；然而，在众多应用场景中，显示器的便携性是首要考虑因素。我们将简要探讨实现便携化方案的潜在途径。
	朝着这一目标（实现便携化方案 ）迈出的一步是，在构建 4f 系统时使用焦距更小的透镜；例如，Chang等人[2018] 使用 30 毫米焦距的透镜，这不仅减小了系统的物理尺寸，还使眼盒（eyebox ）的尺寸增大了3倍。或者，我们可以借鉴Maimone和Wang近期的研究成果[2020]，他们利用偏振敏感光学器件，在不改变设备光学足迹（optical footprint ）的情况下，减小了设备的物理占地面积。然而，4f系统还需要直径足够大的透镜，以避免渐晕现象；具体来说，透镜直径需要大于图像平面和傅里叶平面视场的直径之和。因此，需要采取第二步措施，即突破 4f 系统的限制来实现该系统。补充图 S7 展示了一种避免使用 4f 中继系统的实现方案的原理图和光线图。在此方案中，4f 系统被替换为一个焦距为 $f_0$ 的单透镜，该透镜放置在距离显示器和相位空间光调制器（SLM ）均为 $2f_0$ 的位置；立方相位板与该透镜共位放置。此系统在显示器和SLM之间实现了 1:1 的图像中继。假设SLM上有恒定的相位图案，由于缺乏远心特性，反射光再次出现在透镜平面时会发生显著偏移；这意味着我们需要将立方波前与一个偏移后的副本耦合，而偏移量取决于显示器上点的横向位置。为了解决这个问题，我们在SLM顶部引入一个场镜；该场镜经过设计，使得SLM上每个点的反射光都能与立方相位板的孔径精确重叠；由于镜面反射，我们得到相同但在SLM上翻转的波前，因此，当SLM不发挥作用时，立方相位板产生的影响会如我们期望的那样相互抵消。要产生空间变化的聚焦效果，和之前一样，我们在SLM上添加线性相位斜坡，这会在立方相位板之间产生适当的偏移。
	补充图 S7c 展示了采用该系统渲染出的图像；我们在此次模拟中运用了光线追踪技术。可以清晰地看到散焦效果，这些效果取决于我们在空间光调制器（SLM）上引入的倾斜程度。该系统最大的优势在于，相较于 4f 系统，我们能够使用焦距 $f_0$ 更小、直径也更小的透镜来实现该系统。类似的系统已在近眼配置中得到应用（例如，可参考 Hua [2017] 以及 Hu 和 Hua [2014] 的研究 ）。然而，这类实现方案存在明显的挑战，包括当我们减小透镜焦距时，球差和色差会显著增大，要减弱这些影响，就需要复杂精妙的光学工程手段 。
	![[S7.png]]
	**图S7. 为减小Split - Lohmann显示器总体尺寸而提出的避免使用4f系统的设计方案** (a) 系统原理图，展示该系统如何避免使用 4f 中继；此处，为避免渐晕现象，我们在空间光调制器（SLM）上添加了一个场镜，其焦距经过精确计算，以消除场效应。(b) 不同深度点构成的稀疏场景的光线图及渲染散景效果。(c) 更复杂场景的渲染焦栈。这些渲染结果是使用 Blender 软件，在$f_0 = 100$毫米的条件下获得的。（鸣谢：3D场景由Blender Market的“Entity Designer”提供 ）
- **结论：**
	本文通过提出一种单次成像显示器，推进了多焦点显示器的发展，该显示器对显示像素的深度具备大幅增强的空间选择性。我们系统的核心技术贡献在于一种光学装置，借助 “拆分” 版的 Lohmann 透镜，实现了焦距可空间变化调节的透镜，能够对构成 Lohmann 透镜的两块立方相位板之间的偏移量，进行独立的局部且非机械式控制。我们构建的多焦点显示器保留了显示器的分辨率，无需任何时间复用，就能在 25 - 50 个焦平面上进行深度选择。
	Split - Lohmann 概念的应用潜力远不止于 3D 显示器系统。其核心在于，它能够改变与像平面上不同空间位置相关联的焦平面；显示器与相机之间的基本对偶性，原则上应能实现自适应且随空间变化的对焦功能，甚至有可能借助经过重新设计的系统实现全对焦拍摄 。
